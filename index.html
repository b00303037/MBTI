<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MBTI å‹•ç‰©äººæ ¼æ¸¬é©—</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --primary-color: #6c5ce7;
        --bg-gradient: linear-gradient(135deg, #a8edea 0%, #fedfe3 100%);
      }

      body {
        font-family: 'Noto Sans TC', sans-serif;
        background: var(--bg-gradient);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 0;
        padding: 20px;
      }

      .card {
        background: white;
        border-radius: 24px;
        padding: 40px;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        width: 100%;
        max-width: 450px;
        text-align: center;
      }

      .question-page {
        display: none;
      }
      .active {
        display: block;
        animation: fadeIn 0.5s ease;
      }

      h2 {
        color: #2d3436;
        margin-bottom: 20px;
        font-size: 1.5rem;
        line-height: 1.4;
      }

      .options-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 14px;
        margin-top: 10px;
      }

      .option-btn {
        border: 2px solid #f0f0f0;
        border-radius: 20px;
        background: white;
        cursor: pointer;
        width: 100%;
        aspect-ratio: 1 / 1;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 0;
        font-size: 36px;
        transition: all 0.2s;
        line-height: 1;
      }

      .option-btn:hover {
        border-color: var(--primary-color);
        background: #f8f7ff;
        transform: translateY(-2px);
      }

      .animal-emoji {
        font-size: 80px;
        margin-bottom: 10px;
        display: block;
      }

      .animal-emoji img {
        width: 80px;
        height: 80px;
        object-fit: contain;
        display: block;
        margin: 0 auto;
      }

      .option-btn img {
        width: 36px;
        height: 36px;
        object-fit: contain;
      }

      .mbti-code {
        font-size: 3rem;
        font-weight: 800;
        color: var(--primary-color);
        margin: 0;
        letter-spacing: 2px;
      }

      .animal-name {
        font-size: 1.4rem;
        font-weight: 700;
        color: #2d3436;
        margin: 10px 0 20px 0;
      }

      .restart-btn {
        background: var(--primary-color);
        color: white;
        border: none;
        padding: 14px 40px;
        border-radius: 50px;
        font-size: 1rem;
        cursor: pointer;
        margin-top: 20px;
        box-shadow: 0 4px 15px rgba(108, 92, 231, 0.3);
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
    </style>
  </head>

  <body>
    <div class="card">
      <!-- å–®ä¸€é¡Œï¼šåªé¡¯ç¤º emoji é¸é … -->
      <div id="q1" class="question-page active">
        <h2>ä½ æ˜¯å“ªä¸€ç¨®å‹•ç‰©ï¼Ÿ</h2>
        <div id="options" class="options-grid"></div>
      </div>

      <!-- çµæœé  -->
      <div id="result" class="question-page">
        <span id="result-emoji" class="animal-emoji"></span>
        <div id="mbti-result" class="mbti-code"></div>
        <div id="animal-desc" class="animal-name"></div>
        <button class="restart-btn" id="restartBtn">å†æ¸¬ä¸€æ¬¡</button>
      </div>
    </div>

    <script>
      // 16 ç¨® MBTI -> å‹•ç‰©åç¨± + emoji
      const mbtiData = {
        INFP: { name: 'æº«æŸ”å°ç¾Š', emoji: 'ğŸ‘' },
        INFJ: { name: 'ç¥ç¥•éˆæ€§è²“', emoji: 'ğŸˆâ€â¬›' },
        ENFP: { name: 'å¿«æ¨‚å°ç‹—', emoji: 'ğŸ¶' },
        ENFJ: { name: 'æº«æš–é¹¿å¯¶å¯¶', emoji: 'ğŸ¦Œ' },
        INTJ: { name: 'å†·éœé»‘è±¹', emoji: 'ğŸ†' },
        INTP: { name: 'æ€æƒ³å®¶å°å€‰é¼ ', emoji: 'ğŸ¹' },
        ENTP: { name: 'å¤éˆç²¾æ€ªç‹ç‹¸', emoji: 'ğŸ¦Š' },
        ENTJ: { name: 'éœ¸æ°£ç…å­', emoji: 'ğŸ¦' },
        ISFP: { name: 'æ‰è¯å…”å…”', emoji: 'ğŸ°' },
        ISFJ: { name: 'å®ˆè­·è€…ç„¡å°¾ç†Š', emoji: 'ğŸ¨' },
        ESFP: { name: 'æ´¾å°å°è±¬', emoji: 'ğŸ·' },
        ESFJ: { name: 'å‹å–„è²“ç†Š', emoji: 'ğŸ¼' },
        ISTP: { name: 'é…·é…·å°æµ£ç†Š', emoji: 'ğŸ¦' },
        ISTJ: { name: 'èªçœŸå°æµ·ç‹¸', emoji: 'ğŸ¦«' },
        ESTP: { name: 'å¸¥æ°£é¦¬å…’', emoji: 'ğŸ´' },
        ESTJ: { name: 'å¯é ç‰›ç‰›', emoji: 'ğŸ®' },
      };

      const q1El = document.getElementById('q1');
      const resultEl = document.getElementById('result');
      const optionsEl = document.getElementById('options');

      const resultEmojiEl = document.getElementById('result-emoji');
      const mbtiResultEl = document.getElementById('mbti-result');
      const animalDescEl = document.getElementById('animal-desc');

      const restartBtn = document.getElementById('restartBtn');

      const specialImageSrc = 'maoramei.png';

      // ã€Œç‰¹åˆ¥é¸é …ã€ç‹€æ…‹ï¼šæ¯æ¬¡æŒ‰å†æ¸¬ä¸€æ¬¡ï¼Œæœ‰ 50% æ©Ÿç‡å•Ÿç”¨
      let specialKey = null; // è¢«æ”¹æˆç‰¹æ®Šåœ–ç‰‡çš„é‚£ä¸€å€‹ MBTI key
      let originalEmoji = null; // æ–¹ä¾¿éœ€è¦çš„è©±å¯è¿½è¹¤åŸ emojiï¼ˆé€™ç‰ˆä¸å¿…é‚„åŸï¼Œå› ç‚ºæ¯æ¬¡éƒ½é‡å»ºé¸é …ï¼‰

      function getRandomKey(obj) {
        const keys = Object.keys(obj);
        return keys[Math.floor(Math.random() * keys.length)];
      }

      function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
      }

      function maybeActivateSpecialOption() {
        // 50% æ©Ÿç‡ï¼šå°‡ä»»ä¸€é¸é … emoji æ”¹æˆç‰¹æ®Šåœ–ç‰‡
        if (Math.random() < 0.5) {
          specialKey = getRandomKey(mbtiData);
          originalEmoji = mbtiData[specialKey].emoji;
        } else {
          specialKey = null;
          originalEmoji = null;
        }
      }

      function renderOptions() {
        optionsEl.innerHTML = '';

        const shuffledEntries = shuffleArray(Object.entries(mbtiData));
        shuffledEntries.forEach(([mbti, data]) => {
          const btn = document.createElement('button');
          btn.type = 'button';
          btn.className = 'option-btn';

          // é¸é …åªé¡¯ç¤º emojiï¼›è‹¥è©² key è¢«æŒ‡å®šç‚º specialï¼Œé¡¯ç¤ºç‰¹æ®Šåœ–ç‰‡
          if (mbti === specialKey) {
            const img = document.createElement('img');
            img.src = specialImageSrc;
            img.alt = 'ç‰¹åˆ¥é¸é …';
            btn.appendChild(img);
          } else {
            btn.textContent = data.emoji;
          }

          btn.addEventListener('click', () => selectAnimal(mbti));
          optionsEl.appendChild(btn);
        });
      }

      function selectAnimal(mbti) {
        const data = mbtiData[mbti];

        // åˆ‡é 
        q1El.classList.remove('active');
        resultEl.classList.add('active');

        // è‹¥é»åˆ°è¢«æ”¹æˆç‰¹æ®Šåœ–ç‰‡çš„é‚£å€‹é¸é …ï¼šé¡¯ç¤ºã€Œä½ æ˜¯æœ€ç‰¹åˆ¥çš„ã€
        if (specialKey && mbti === specialKey) {
          resultEmojiEl.innerHTML = '';
          const img = document.createElement('img');
          img.src = specialImageSrc;
          img.alt = 'ç‰¹åˆ¥é¸é …';
          resultEmojiEl.appendChild(img);
          mbtiResultEl.innerText = 'MAORAMEI';
          animalDescEl.innerText = 'ä½ æ˜¯ï¼šè²“è¾£å¦¹ï¼';
          return;
        }

        // ä¸€èˆ¬çµæœ
        resultEmojiEl.innerText = data.emoji;
        mbtiResultEl.innerText = mbti;
        animalDescEl.innerText = `ä½ çš„å‹•ç‰©éˆé­‚æ˜¯ï¼š${data.name}`;
      }

      function restart() {
        // å›åˆ°ç¬¬ä¸€é¡Œ
        resultEl.classList.remove('active');
        q1El.classList.add('active');

        // è§¸ç™¼ 50% æ©Ÿç‡ç‰¹æ®Šäº‹ä»¶ï¼Œç„¶å¾Œé‡ç•« 16 å€‹ emoji é¸é …
        maybeActivateSpecialOption();
        renderOptions();
      }

      // åˆå§‹è¼‰å…¥ï¼šå…ˆæ±ºå®šæ˜¯å¦è¦æœ‰ âœ¨ ç‰¹åˆ¥é¸é …ï¼Œå†æ¸²æŸ“
      (function init() {
        maybeActivateSpecialOption();
        renderOptions();
        restartBtn.addEventListener('click', restart);
      })();
    </script>
  </body>
</html>
